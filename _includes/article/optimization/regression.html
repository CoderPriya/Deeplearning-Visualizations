<div class="visualization hide-backToTop" id="regression">
    <div class="visualization-column-4">
        <p>In this visualization, your goal is to recover the ground truth parameters used to generate a training set. You can fit a linear model $\hat{y} = wx + b$ on the training set using gradient descent. Press the button to generate a dataset of chosen size (<b>1</b>) and observe its impact on the cost landscape. Then, choose initial values of your model parameters by dragging the <span class="red">red dot</span> (<b>2</b>) before optimizing (<b>3</b>).</p>
    </div>
    <div class="visualization-column-1">
        <!-- <p>In this visualization, your goal is to recover the ground truth parameters used to generate a training set. You can fit a linear model <script>document.write(katex.renderToString('\\hat{y} = wx + b'))</script> on the training set using gradient descent. Press the button to generate a dataset of chosen size (<b>1</b>) and observe its impact on the cost landscape. Then, choose initial values of your model parameters by dragging the <span class="red">red dot</span> (<b>2</b>) before optimizing (<b>3</b>).</p> -->
        <h3>1. Generate a dataset</h3>
        <p>Select a training set size $m$.</p>
        <label class="radio-container">Small
            <input type="radio" value="20" name="regression_tsize">
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">Medium
            <input type="radio" value="300" name="regression_tsize" checked>
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">Large
            <input type="radio" value="800" name="regression_tsize">
            <span class="checkmark"></span>
        </label>
        <p>A training set of the chosen size will be sampled with noise from a line representing <span class="blue">ground truth</span>. This line is the target line for the <span class="red">model</span> defined by $\hat{y} = wx + b$.</p>
        <button class="button-transport" id="generate">
           Generate a new dataset.
        </button>
        <div id="regression_plot" style="margin-top:1em;border: 1px solid rgba(0,0,0,0.2);"></div>
    </div>
    <div class="visualization-column-2">
        <h3>2. Observe the cost landscape and initialize parameters.</h3>
        <p>The cost function is the L2 loss (defined as $\mathcal{L}(y, \hat{y}) = ||y - \hat{y}||_2^2$) averaged over the training set. The <span class="blue">blue dot</span> indicates the value of the cost function at the ground-truth slope and intercept. The <span class="red">red dot</span> indicates the value of the cost function at a chosen initialization of the slope and intercept. Drag and drop the red dot to change the initialization.</p>
        <div id="regression_landscape"></div>
    </div>
    <div class="visualization-column-1">
        <h3>3. Optimize the cost function</h3>
        <p>Now you can update the parameters iteratively to minimize the cost. Select a learning rate.</p>
        <label class="radio-container">Small
            <input type="radio" value="0.0001" name="regression_lrate">
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">Medium
            <input type="radio" value="0.01" name="regression_lrate" checked>
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">Large
            <input type="radio" value="0.1" name="regression_lrate">
            <span class="checkmark"></span>
        </label>
        <p>Select a batch size.</p>
        <label class="radio-container">$m_b = 1$
            <input type="radio" value="1" name="regression_bsize" checked>
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">$m_b = 24$
            <input type="radio" value="24" name="regression_bsize">
            <span class="checkmark"></span>
        </label>
        <label class="radio-container">$m_b = m$
            <input type="radio" value="300" name="regression_bsize">
            <span class="checkmark"></span>
        </label>
        <p>Train the <span class="red">model</span>.</p>
        <button class="button-transport" id="regression_reset" title="reset">
            <img src="../assets/images/layout/reset.png">
        </button>
        <button class="button-transport" id="regression_train" title="start">
            <img src="../assets/images/layout/play.png">
        </button>
        <button class="button-transport hidden" id="regression_stop" title="stop">
            <img src="../assets/images/layout/pause.png">
        </button>
        <div id="regression_loss"></div>
    </div>
</div>