<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A visual introduction to probability and statistics.">
    <meta name="author" content="--">
    <title>Xavier Initialization</title>
    <!-- Fonts -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Assistant:300,400,600,700" rel="stylesheet">
    <!-- Home Page CSS -->
    <link rel="stylesheet" type="text/css" href="css/template.css">
    <!--Favicon-->
    <link rel="shortcut icon" type="image/png" href="img/favicon.png" />
    <!-- Home Page CSS -->
    <link rel="stylesheet" href="css/main.css">
    <!-- Load jquery -->
    <script src="js/jquery.js"></script>
    <!-- Load jquery UI -->
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <script src="js/jquery-ui.min.js"></script>
    <!-- Load D3 -->
    <script src="js/d3.min.js"></script>
    <!-- Load Deeplearn -->
    <script src="https://unpkg.com/deeplearn@latest"></script>
    <!-- Data Generattion Code -->
    <script src="js/data.js"></script>
    <!-- Neural Network Code -->
    <script src="js/nn.js"></script>
    <!-- Visualization Code -->
    <script src="js/viz.js"></script>
</head>

<body>
    <div class="header"></div>
    <div class="main divider-bottom">
        <div class="container">
            <div class="column-6-8">
                <h1 class="title">Xavier Initialization</h1>
                <h2>The lack of initialization techniques is one of the major reasons deep neural networks weren’t training properly in the past decades. Since then, new initializations schemes have been found to accelerate training. In this post, we will explain the methods to initialize the parameters of your neural network.</h2>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="container">
            <div class="column-6-8 divider-bottom">
                <h3>Problem statement</h3>
                <p>A neural network model is defined by its <i>architecture</i> and its <i>parameters</i>. In order to build a cat classifier with a 3-layer neural network (architecture), you need to learn the parameters using the optimization process:
                </p>
                <ol>
                    <li>Initialize the parameters</li>
                    <li>Use an optimization algorithm, repeat:</li>
                    <ol>
                        <li>Forward propagate an input image</li>
                        <li>Compute the cost</li>
                        <li>Backward propagation the gradients</li>
                        <li>Update the parameters using gradient descent (for example)</li>
                    </ol>
                </ol>
                <p>
                Given a new image, you can then use your model (architecture + learned parameters) to predict if there’s a cat.
                </p>
                <p>
                To illustrate our argumentation let’s consider this 3-layer neural network. You can play with different initialization scheme and observe their impact on the learning.
                </p>
            </div>
            <div class="column-2-8 column-align">
                <h3>Input Data</h3>
                <p>Choose a dataset as input to the neural network and select whether to view weights or gradients.</p>
                <label class="radio-container">Gradients
                    <input type="radio" value="gradient" name="link">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Weights
                    <input type="radio" value="weight" name="link" checked>
                    <span class="checkmark"></span>
                </label>
            </div>
            <div class="column-4-8 column-align">
                <h3>Neural Network</h3>
                <p>Select a variance to initialize weights with.</p>
                <div id="slider"></div>
                <label class="radio-container">All Zeros
                    <input type="radio" checked="checked" name="init">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Too Small
                    <input type="radio" name="init">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Xe Initialization
                    <input type="radio" name="init" checked>
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Too Large
                    <input type="radio" name="init">
                    <span class="checkmark"></span>
                </label>
            </div>
            <div class="column-2-8 column-align">
                <h3>Output Classification</h3>
                <p>Train model.</p>
                <div>
                    <button class="button" id="reset">Reset</button>
                    <button class="button" id="train">Train</button>
                </div>
            </div>
            <div class="column-2-8 column-align lg-screen-img">
                <div id="datasets"></div>
                <div id="legend"></div>
            </div>
            <div class="column-4-8 column-align lg-screen-img">
                <div id="network"></div>
            </div>
            <div class="column-2-8 column-align lg-screen-img">
                <div id="loss"></div>
                <div id="output"></div>
            </div>
            <div class="column-6-8 column-align">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div>
            <div class="column-2-8 column-align">
                <p class="caption">Zero initialization doesn’t work because it lacks at breaking the symmetry.</p>
            </div>
            <div class="column-6-8">
                <h3>What are the issues with a bad initialization?</h3>
                <p>An inappropriate initialization leads to:</p>
                <ol>
                    <li>Vanishing gradient -> parameters values get stuck</li>
                    <li>Exploding gradients -> parameters values diverge</li>
                </ol>
                <p>In both cases, parameters do not converge to “good” values. Let’s illustrate this.</p>
                <p>Consider this 9-layer neural network just after it was initialized.</p>
                <img src="img/image-placeholder.png">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. </p>
            </div>
        </div>
        <div class="full-container-image">
            <img src="img/image-placeholder.png">
            <div class="container">
                <div class="column-3-4">
                    <p class="img-caption">image caption</span>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="column-6-8">
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            </div>
            <div class="column-8-8 divider-bottom"></div>
            <div class="column-2-8 column-align">
                <h3>Exploding Gradient</h3>
                <p>Consider the case where every weight is initialized slightly larger than the identity matrix. This simplifies to __, and the values of the activation __ increase exponentially with __. When these activations are used in backward propagation, this leads to the exploding gradient problem that you could visualize on the contour plot of the loss as:</p>
            </div>
            <div class="column-6-8 column-align">
                <img src="img/exploding.png">
            </div>
            <div class="column-2-8 column-align">
                <h3>Vanishing Gradient</h3>
                <p>Similarly, consider the case where every weight is initialized slightly smaller than the identity matrix. This simplifies to __, and the values of the activation __  decreases exponentially with __. When these activations are used in backward propagation, this leads to the vanishing gradient problem that you could visualize on the contour plot of the loss as:</p>
            </div>
            <div class="column-6-8 column-align">
                <img src="img/vanishing.png">
            </div>
            <div class="column-6-8 divider-bottom">
                <p>All in all, initializing your weights with inappropriate values will lead to divergence or slow-down in the training.</p>
            </div>
            <div class="column-6-8">
                <h3>How do we fix this issue?</h3>
                <p>Let's define our rule of thumb to translate the fact that we want the weights to be initialized neither “too big”, nor “too small”:</p>
                <p>The variance should stay the same across every layer to prevent the signal from vanishing or exploding</p>
                <img src="img/network.png">
            </div>
            <div class="column-6-8">
                <h5>Default button</h5>
                <button class="button">button</button>

                <h5>Emphasized button</h5>
                <button class="button emphasized">button</button>

                <h5>Radio button</h5>
                <label class="radio-container">One
                    <input type="radio" checked="checked" name="radio">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Two
                    <input type="radio" name="radio">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Three
                    <input type="radio" name="radio">
                    <span class="checkmark"></span>
                </label>
                <label class="radio-container">Four
                    <input type="radio" name="radio">
                    <span class="checkmark"></span>
                </label>

                <h5>Slider</h5> 
                <input type="range" min="0" max="1" step="0.01" value="0.5">
                          
            </div>
        </div>
    </div>
    <div class="footer"></div>
</body>