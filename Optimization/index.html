<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Learn how to appropriately initialize parameters in your neural networks.">
    <meta name="author" content="--">
    <title>Optimization</title>
    <!-- Fonts -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Assistant:300,400,600,700" rel="stylesheet">
    <!-- Home Page CSS -->
    <link rel="stylesheet" type="text/css" href="../css/template.css">
    <!--Favicon-->
    <link rel="shortcut icon" type="image/png" href="../img/favicon.png" />
    <!-- Load jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Load D3 -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <!-- Load Tensorflow -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.9.0">
    </script>
    <!-- Load Katex -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>
    <!--Scroll To-->
    <script src="../js/template.js"></script>
</head>

<body>
    <div class="header"> 
        <div class="header-wrapper">

        	<a href="https://www.deeplearning.ai/"><img id="header-logo" class="cppnControl" src="../img/deeplearning.png"></a>
            <a><img id="header-logo" class="cppnControl"></a>
            <!-- Uncomment below to add links to other articles -->
            <ul class="header-nav">
                 <li><a href="../Regularization/index.html">Regularization</a></li>
                <li><strong>Optimization</strong></li>
                <li><a href="../Initialization/index.html">Initialization</a></li>
            </ul>
        </div>
    </div>
    <div class="main vis-background">
        <div class="container" >
            <div class="column-6-8 column-align" >
                <h1 class="title">Optimizing your neural networks</h1>
                 <p class="title" > <a href="https://twitter.com/kiankatan">Kian Katanforoosh</a> & <a href="http://daniel-kunin.com">Daniel Kunin</a></p>
            </div>
        </div>
        
    </div>
    <div class="main intro ">
        <div class="container divider-bottom" >
            <div class="column-6-8 column-align" >
               
                <h2 class="title">Optimization is a core technique for training your machine learning algorithm Through interactive visualizations, you will learn the intuition behind neural network optimization. In machine learning, you first define a task, such as detecting cats on an image, and an objective (or loss) function to evaluate how well you perform on that task. Then, you find the architecture and parameters that result in an optimal value for your objective.</h2>
               
            </div>

            <div class="column-2-8 column-align">
                <h3 class="tableOfContent">Table of content</h3>
                <ol class="tableOfContent" type="I">
                    <li class="index index1">Setting-up the optimization problem</li>
                    <li class="index index2">Running the optimization process</li>
                </ol>
            </div>
        </div>
    </div>

    <div class="main">
        <div class="container index1-target">
            <div class="column-6-8 column-align">
                <h3>I&emsp;Setting-up the optimization problem</h3>
                <p>The way you define your task is the primary factor influencing how your model is going to train and perform. Say your task is to detect cars in images. Your objective function should be the following:</p>
                <p class="inline-caption">Given an image, output bounding boxes that contain all the cars on the image. Your output boxes should match the labeled boxes.</p>
                <p>In mathematical terms, a possible loss (or objective) function L is:</p>
                <p>This loss function depends on:</p>
                <ul>
                    <li>The parameters of the network (weights and biases)</li>
                    <li>The batch of inputs given to the network</li>
                    <li>The batch of ground truths corresponding to the input batch given to the network</li>
                </ul>
                <p>For a fixed value of the input batch and ground truths batch, the loss has a landscape that depends on the parameters of the network. You can try to find the minimum point on the loss landscape, but the loss landscape is almost impossible to visualize if there are more than 2 parameters.</p>
                <p>Although it is hard to visualize the loss landscape when the network has more than 3 parameters, the landscape still exists. Updating the values will move the parameters either closer to or farther from the minimum point of this landscape. (In another AI note, you will learn techniques to visualize your loss function in higher dimensions.)</p>
            </div>
            <div class="column-6-8">
                <h4>The duality between the network function and the loss function</h4>
            </div>
            <div class="column-6-8 column-align">
                <p>In optimizing your machine learning algorithm, it is important to note the difference between the function you are optimizing (i.e. loss function) and the function you will use to perform the task (i.e. the network function).</p>
                <ul>
                    <li><b>The network function</b> is unknown. The deeper your network is, the harder it is to find a formula for it. You know that the network function is defined by its parameters, and your goal is to find them.</li>
                    <li><b>The loss function</b> is chosen, and you have a formula for it. But its value depends on the parameters and thus the network function.</li>
                </ul>
                <p>Interestingly (or counterintuitively), you are not optimizing the function that you will use to predict your end value (network function). Instead, you are defining a “proxy” function (loss function) which, if minimized, will make your network function correctly.</p>
                <p>You need a loss function because the network function is unknown and you are not sure how to find the correct network function.</p>
                <p>In summary, the way you define your optimization problem will dictate the performance of your network function.</p>
                <img src="img/functiongraph.png">
            </div>
        </div>
        <div class="container index2-target">
            <div class="column-6-8 column-align">
                <h3>II&emsp;Running the optimization process</h3>
                <p>In this section, assume that you have already chosen a task and a loss function. You will minimize the loss function to find the network function.</p>
            </div>
            <div class="column-6-8">
                <h4>Initialization, learning rate and batch size</h4>
            </div>
            <div class="column-6-8 column-align">
                <p>First, initialize the parameters of the network function so that you have a starting point for your optimization. You also need to choose your hyperparameters such as the learning rate and the batch size. They will have an important influence on the optimization.</p>
                <p>In the visualization below, you will play with the starting point of initialization, the learning rate, and the batch size. With these parameters, you will fit a linear regression on a set of 300 data points using the gradient descent optimization algorithm. For more information on gradient descent optimization, refer to the Deep Learning Specialization (<a href="https://www.coursera.org/learn/neural-networks-deep-learning">Course 1</a>: “Neural Networks and Deep Learning”, Week 2: “Logistic Regression as a Neural Network”.) Here are some questions you should ask yourself:</p>
                <ul>
                    <li>Why does the loss landscape look like this?</li>
                    <li>What is the red bullet?</li>
                    <li>Why can your optimization end-up with a lower cost value than the ground truth line?</li>
                    <li>What is the impact of the learning rate on the optimization?</li>
                    <li>What is the impact of the batch size on the optimization?</li>
                </ul>
            </div>
        </div>





        <div class="full-container" id="landscape">
            <div class="viz-column-2-8">
                <h3>1. Choose Function</h3>
                <p>Choose the intercept and slope for the "true" function that we will try to learn.</p>
                <div class="regression_coefficients">
                    Intercept<br>
                    <label>
                      <input type="radio" name="intercept" value="-3" />
                      <img src="./img/regression/neg_intercept.png">
                    </label>
                    <label>
                      <input type="radio" name="intercept" value="0" checked/>
                      <img src="./img/regression/no_intercept.png">
                    </label>
                    <label>
                      <input type="radio" name="intercept" value="3"/>
                      <img src="./img/regression/pos_intercept.png">
                    </label>
                    <br>
                    Slope<br>
                    <label>
                      <input type="radio" name="slope" value="-3" />
                      <img src="./img/regression/neg_slope.png">
                    </label>
                    <label>
                      <input type="radio" name="slope" value="0" checked/>
                      <img src="./img/regression/no_slope.png">
                    </label>
                    <label>
                      <input type="radio" name="slope" value="3" />
                      <img src="./img/regression/pos_slope.png">
                    </label>
                </div>
                <svg id="regression_plot" width=300 height=300></svg>
            </div>
            <div class="viz-column-4-8">
                <h3>2. Loss Landscape</h3>
                <p>Sample a training set and explore the loss landscape.</p>
                <svg id="regression_landscape" width=450 height=450></svg>
            </div>
            <div class="viz-column-2-8">
                <h3>3. Select Hyperparameters</h3>
                
                <div>
                    Learning Rate:<br>
                    <label class="radio-container">0.0001
	                    <input type="radio" value="0.0001" name="regression_lrate">
	                    <span class="checkmark"></span>
	                </label>
	                <label class="radio-container">0.001
	                    <input type="radio" value="0.001" name="regression_lrate" checked>
	                    <span class="checkmark"></span>
	                </label>
	                <label class="radio-container">0.01
	                    <input type="radio" value="0.01" name="regression_lrate">
	                    <span class="checkmark"></span>
	                </label>
	                <br>
                    Batch Size:<br>
                    <label class="radio-container">Stochastic
	                    <input type="radio" value="1" name="regression_bsize" checked>
	                    <span class="checkmark"></span>
	                </label>
	                <label class="radio-container">Mini
	                    <input type="radio" value="30" name="regression_bsize">
	                    <span class="checkmark"></span>
	                </label>
	                <label class="radio-container">Full
	                    <input type="radio" value="300" name="regression_bsize">
	                    <span class="checkmark"></span>
	                </label>
                </div>
                <button class="button-transport" id="regression_reset" title="reset">
                    <img src="img/reset.png">
                </button>
                <button class="button-transport" id="regression_train" title="start">
                    <img src="img/play.png">
                </button>
                <button class="button-transport hidden" id="regression_stop" title="stop">
                    <img src="img/pause.png">
                </button>
                <svg id="regression_loss" width=300 height=200></svg>
            </div>
        </div>
    </div>

    <div class="main">
        <div class="full-container" id="landscape">
            <div class="viz-column-3-8">
                <h3>1. Choose loss</h3>
                <div class="lossFunctions">
                    <p>Select an <a href="https://en.wikipedia.org/wiki/Test_functions_for_optimization">artificial landscape</a> <script>document.write(katex.renderToString('f(x,y)'))</script>.</p>
                    <label>
                      <input type="radio" name="loss" value="beale" />
                      <img src="./img/loss/beale.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="goldsteinPrice"/>
                      <img src="./img/loss/goldsteinPrice.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="himmelblaus" checked/>
                      <img src="./img/loss/himmelblaus.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="matyas" />
                      <img src="./img/loss/matyas.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="mcCormick" />
                      <img src="./img/loss/mcCormick.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="rastrigin" />
                      <img src="./img/loss/rastrigin.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="rosenbrock" />
                      <img src="./img/loss/rosenbrock.png">
                    </label>
                    <label>
                      <input type="radio" name="loss" value="styblinskiTang" />
                      <img src="./img/loss/styblinskiTang.png">
                    </label>
                </div>
                </br>

                <h3>4. Determine Optimization</h3>
                <div class="lossFunctions">
                    <p>Select which optimization methods to use.</p>
                    
                    <input type="checkbox" name="opt" value="gd"/>
                    <label class="check-box">Gradient Descent</label>

                    </br>
                    <input type="checkbox" name="opt" value="momentum"/>
                    <label class="check-box">Momentum </label>

                    </br>
                    <input type="checkbox" name="opt" value="rmsprop"/>
                    <label class="check-box">RMSprop </label>

                    </br>
                    <input type="checkbox" name="opt" value="adam"/>
                    <label class="check-box">Adam </label>
                </div>
                </br>

                <!-- <h3>5. Update Parameters</h3>
                <p>Select learning rate <script>document.write(katex.renderToString('\\alpha'))</script>, and decay rate <script>document.write(katex.renderToString('\\delta'))</script>.</p>
                <div>
                    <input type="range" value="-3" min="-8" max="0" step="any" id="lrate">
                    </br>
                    <label>Learning Rate = <span id="lrate_val">0.001</span></label>
                    </br></br>
                    <input type="range" value="1" min="0" max="1" step="any" id="ldecay">
                    </br>
                    <label>Learning Rate Decay = <span id="ldecay_val">1</span></label>
                </div>
                </br> -->

                <h3>6. Minimize</h3>
                </br>
                <button class="button-transport" id="reset" title="reset">
                    <img src="img/reset.png">
                </button>
                <button class="button-transport" id="train" title="start">
                    <img src="img/play.png">
                </button>
                <button class="button-transport hidden" id="stop" title="stop">
                    <img src="img/pause.png">
                </button>
            </div>
            <div class="viz-column-4-8">
                <h3>Loss Landscape: <script>document.write(katex.renderToString('(x_{t+1},y_{t+1}) = (x_{t},y_{t}) + \\delta^{t}\\alpha g(x,y)'))</script></h3>
                <svg id="contour" width="550" height="520"></svg>
                <h3>Loss Plot: <script>document.write(katex.renderToString('L(x,y) = f(x,y) + \\lambda r(x,y)'))</script></h3>
                <svg id="loss" width="550" height="200"></svg>
            </div>
        </div>
    </div>
        
    <div class="footer">
        <div class="container">
            <div class="column-2-8 column-align">
                <h4 class="reference">Authors</h4>
            </div>
            <div class="column-6-8 column-align">
                <ol class="reference ">
                    <li><a href="https://twitter.com/kiankatan">Kian Katanforoosh</a> - Written content and structure. </li>
                    <li><a href="http://daniel-kunin.com">Daniel Kunin</a> - Visualizations (created using <a href="https://d3js.org/">D3.js</a> and <a href="https://js.tensorflow.org/">TensorFlow.js</a>).</li>
                </ol>
            </div>
            <div class="column-2-8 column-align">
                <h4 class="reference">Acknowledgments</h4>
            </div>
            <div class="column-6-8 column-align">
                <ol class="reference">
                    <li>The template for the article was designed by <a href="https://www.jingru-guo.com/">Jingru Guo</a> and inspired by <a href="https://distill.pub/">Distill</a>.</li>
                    <li>The loss landscape visualization adapted code from Mike Bostock's <a href="https://bl.ocks.org/mbostock/f48ff9c1af4d637c9a518727f5fdfef5">visualization</a> of the Goldstein-Price function.</li>
                    <li>The banner visualization adapted code from deeplearn.js's implementation of a <a href="https://deeplearnjs.org/demos/nn-art/">CPPN</a>.</li>
                </ol>
            </div>
            <div class="column-2-8 column-align">
                <h4 class="reference">Footnotes</h4>
            </div>
            <div class="column-6-8 column-align">
                <ol class="reference footnote">
                </ol>
            </div>
            <div class="column-2-8 column-align">
                <h4 class="reference">Reference</h4>
            </div>
            <div class="column-6-8 column-align">
                <p class="reference">To reference this article in an academic context, please cite this work as:</p>
                <p class="citation">Katanforoosh & Kunin, "Regularizing your neural networks", deeplearning.ai, 2018.</p>
            </div>
        </div>
    </div>
    <div class="backToTop">
        <p>↑ Back to top</p>
    </div>
</body>

<!-- Additional JS -->
<script src="https://d3js.org/d3-contour.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>

<!-- LANDSCAPE -->
<link rel="stylesheet" href="css/landscape.css">
<script src="js/landscape/point.js"></script>
<script src="js/landscape/loss.js"></script>
<script src="js/landscape/optimizer.js"></script>
<script src="js/landscape/viz.js"></script>

<!-- REGRESSION -->
<link rel="stylesheet" href="css/regression.css">
<script src="js/regression/line.js"></script>
<script src="js/regression/loss.js"></script>
<script src="js/regression/optimizer.js"></script>
<script src="js/regression/viz.js"></script>

<!-- CPPN -->
<script src="js/cppn.js"></script>
