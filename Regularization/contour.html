<!DOCTYPE html>

<!-- Home Page CSS -->
<link rel="stylesheet" type="text/css" href="css/landscape.css">
<div style="width: 500px; display:inline-block;">
	<svg id="contour" width="500" height="500"></svg>
	<svg id="loss" width="500" height="200"></svg>
</div>
<div style="display:inline-block;">
	<div class="lossFunctions">
		<p>Select an <a href="https://en.wikipedia.org/wiki/Test_functions_for_optimization">artificial landscape</a> to explore:</p>
		<label>
		  <input type="radio" name="loss" value="beale" />
		  <img src="./img/beale.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="goldsteinPrice"/>
		  <img src="./img/goldsteinPrice.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="himmelblaus" checked/>
		  <img src="./img/himmelblaus.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="matyas" />
		  <img src="./img/matyas.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="mcCormick" />
		  <img src="./img/mcCormick.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="rastrigin" />
		  <img src="./img/rastrigin.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="rosenbrock" />
		  <img src="./img/rosenbrock.png">
		</label>
		<label>
		  <input type="radio" name="loss" value="styblinskiTang" />
		  <img src="./img/styblinskiTang.png">
		</label>
	</div>
	<div>
		<p>Add regularization:</p>
		<label>L1:</label>
		<input type="radio" name="reg" value="1" />
		<label>L2</label>
		<input type="radio" name="reg" value="0" checked/>
		<br>
		<input type="range" value="0" min="0" max="40" step="any" id="lambda">
		<label>Lambda = <span id="lambda_val">0.00</span></label>
	</div>
	<div class="lossFunctions">
		<p>Choose an optimizer(s):</p>
		<label>SGD </label>
		<input type="checkbox" name="opt" value="sgd"/>
		<label>Momentum </label>
		<input type="checkbox" name="opt" value="momentum"/>
		<label>Nesterov </label>
		<input type="checkbox" name="opt" value="nesterov"/>
		<label>Adagrad </label>
		<input type="checkbox" name="opt" value="adagrad"/>
		<label>RMSprop </label>
		<input type="checkbox" name="opt" value="rmsprop"/>
		<label>Adam </label>
		<input type="checkbox" name="opt" value="adam"/>
		<br>
		<input type="range" value="-3" min="-8" max="0" step="any" id="lrate">
		<label>Learning Rate = <span id="lrate_val">0.001</span></label>
	</div>
	<button id="init">Init</button>
	<button id="train">Train</button>
	<button id="reset">Reset</button>
</div>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-contour.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js"></script>
<!-- Load jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="js/point.js"></script>
<script src="js/loss.js"></script>
<script src="js/optimizer.js"></script>
<script>

	var lossObject = new loss('himmelblaus', 0, 0, d3.select("#contour"));
	var optObject = new optimizer(lossObject, d3.select("#loss"));
	lossObject.plot();

	$("input[name='loss']").on("change", function () {
		optObject.reset();
		lossObject.func = this.value;
	    lossObject.plot(0);
	});

	$("input[name='reg']").on("change", function () {
		optObject.reset();
		lossObject.alpha = this.value;
	    lossObject.plot(0);
	});

	$("#lambda").on("input", function () {
		optObject.reset();
		$("#lambda_val").html(d3.format(".2")(this.value));
		lossObject.lambda = this.value;
	    lossObject.plot(0);
	});

	$("input[name='opt']").on("change", function () {
		optObject.reset();
		var index = optObject.rule.indexOf(this.value);
		if (index == -1) {
			optObject.rule.push(this.value);
		} else {
			optObject.rule.splice(index, 1);
		}
	});

	$("#lrate").on("input", function () {
		optObject.reset();
		$("#lrate_val").html(d3.format(".2")(10**this.value));
		optObject.lrate = 10**this.value;
	});

	$("#init").on("click", function () {
		optObject.reset();
		optObject.init();
	});

	$("#train").on("click", function () {
		optObject.reset();
		optObject.train();
	});

	$("#reset").on("click", function () {
		optObject.reset();
	});

</script>



<!-- TO DO -->
<!-- Clean up main for viz -->
<!-- Add css template -->
<!-- Tool tip for optimization paths -->
<!-- Drag and drop for initial point -->
<!-- clean and comment -->